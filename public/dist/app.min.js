function _dntEnabled(a,b){"use strict";var c=a||navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,d=b||navigator.userAgent,e=d.match(/Firefox\/(\d+)/),f=/MSIE|Trident/i,g=f.test(d),h=d.match(/Windows.+?(?=;)/g);return!(g&&"function"!=typeof Array.prototype.indexOf)&&(c=e&&32>parseInt(e[1],10)?"Unspecified":g&&h&&-1!==["Windows NT 6.1","Windows NT 6.2","Windows NT 6.3"].indexOf(h.toString())?"Unspecified":{0:"Disabled",1:"Enabled"}[c]||"Unspecified","Enabled"===c)}function browserName(){try{return /firefox/i.test(navigator.userAgent)?"firefox":/edge/i.test(navigator.userAgent)?"edge":/trident/i.test(navigator.userAgent)?"ie":/chrome/i.test(navigator.userAgent)?"chrome":/safari/i.test(navigator.userAgent)?"safari":"other"}catch(a){return"unknown"}}function removeUtms(){const a=window,b=a.location;b.search.includes("utm_")&&a.history.replaceState&&a.history.replaceState({},"",b.pathname)}if("firefox"===browserName()&&(document.getElementById("download-firefox")||document.getElementById("download-firefox-bar"))&&document.querySelectorAll(".download-firefox").forEach(a=>{a.classList.add("hide")}),_dntEnabled()||function(b,c,d,e,f,g,h){b.GoogleAnalyticsObject=f,b[f]=b[f]||function(){(b[f].q=b[f].q||[]).push(arguments)},b[f].l=1*new Date,g=c.createElement(d),h=c.getElementsByTagName(d)[0],g.async=1,g.src=e,h.parentNode.insertBefore(g,h)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),"undefined"!=typeof ga){ga("create","UA-77033033-16"),ga("set","anonymizeIp",!0);const a=document.location;let b=a.pathname+a.search;a.search&&(a.search.includes("token=")||a.search.includes("hash="))&&(b=a.pathname,ga("set","location",b),ga("set","page",b)),ga("send","pageview",{hitCallback:removeUtms})}if("use strict","undefined"==typeof TextEncoder){const a=document.createElement("script"),b=document.getElementsByTagName("script")[0];a.src="/dist/edge.min.js",b.parentNode.insertBefore(a,b)}const eventList={Social:{eventCategory:"Social",eventAction:"Share"},SignUp:{eventCategory:"Sign Ups",eventAction:"Button Click"},SignUp_Complete:{eventCategory:"Sign Ups",eventAction:"Complete"},Resend:{eventCategory:"Resend Confirmation Email",eventAction:"Button Click"},CloseModal:{eventCategory:"Modal Closes",eventAction:"Closed Modal"},Unsubscribe:{eventCategory:"Unsubscribe",eventAction:"Button Click"},UnsubscribeSurvey:{eventCategory:"Unsubscribe Survey Submittal",eventAction:"Button Click"},Scan:{eventCategory:"Scans",eventAction:""},ShowAdditional:{eventCategory:"Show Additional Breaches",eventAction:"Button Click"},Pageview:{eventCategory:"Views",eventAction:""},Download:{eventCategory:"Download",eventAction:"Firefox Download"},Link:{eventCategory:"Link Clicks",eventAction:"Link Click"},ShareByEmail:{eventCategory:"ShareByEmail",eventAction:"Shared Firefox Monitor"}};function ga_getLocation(){return document.querySelector(".landing-content")?document.getElementById("sensitive-featured-breach")?"Sensitive Featured Breach Page":document.getElementById("featured-breach")?"Featured Breach Page":"Landing Page":document.getElementById("found-breaches")?"Scan Results - found breaches":document.getElementById("no-breaches")?"Scan Results - no breaches":document.getElementById("unsubscribe")?"Unsubscribe Page":document.getElementById("unsubscribe-survey")?"Unsubscribe Survey":"error"===document.getElementById("subpage").getAttribute("data-analytics-id")?"Error":document.getElementById("confirmation")?"Account Confirmation Page":"Firefox Monitor"}function ga_sendPing(a,b){if("undefined"!=typeof ga){const c=eventList[a],d=c.eventCategory,e=c.eventAction;return b=b?b+" --- "+ga_getLocation():ga_getLocation(),ga("send","event",d,e,b)}}function isValidEmail(a){const b=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return b.test((a+"").toLowerCase())}function removeInvalidMessage(a){const b=a.target.form;b.classList.remove("invalid")}function doOauth(){window.open("/oauth/init")}function setModalTabbing(){let a=Array.from(document.getElementById("subscribe-to-ffxm").querySelectorAll("a, input, button"));return document.getElementById("subscribe-to-ffxm").classList.contains("show")||(a=Array.from(document.getElementById("confirm-your-account").querySelectorAll("a, input, button"))),document.body.classList.contains("show-subscribe-modal")?void document.querySelectorAll("a, button, input").forEach(b=>{b.setAttribute("tabindex",a.includes(b)?"1":"-1")}):void document.querySelectorAll("a, button, input").forEach(b=>{b.setAttribute("tabindex",a.includes(b)?"-1":"1")})}const focusFirstInput=function(a){a.target.querySelector("input")&&a.target.querySelector("input").focus(),a.target.removeEventListener("transitioned",focusFirstInput)};function closeModalWindow(){document.body.classList.remove("show-subscribe-modal"),document.getElementById("subscribe-to-ffxm").classList.remove("show");document.getElementById("subscribe-modal").classList.contains("fxa-enabled")||(document.getElementById("confirm-your-account").classList.remove("show","sending","sent"),document.getElementById("subscribe-form").classList.remove("invalid"),document.getElementById("subscribe-email-input").value="",document.getElementById("additional-emails-checkbox").checked=!1,setModalTabbing())}function openModalWindow(){const a=document.getElementById("subscribe-modal");document.body.classList.add("show-subscribe-modal"),document.getElementById("subscribe-to-ffxm").classList.add("show"),setModalTabbing();a.classList.contains("fxa-enabled")||(document.getElementById("subscribe-form").classList.remove("loading-data"),a.addEventListener("transitionend",a=>focusFirstInput(a)),a.addEventListener("click",function b(c){c.target===a&&(document.getElementById("subscribe-to-ffxm").classList.contains("show")?ga_sendPing("CloseModal","Clicked outside modal to close - Before Sign Up"):ga_sendPing("CloseModal","Clicked outside modal to close - After Sign Up"),closeModalWindow(),document.getElementById("subscribe-modal").removeEventListener("click",b))}))}function checkBoxStates(a){a.preventDefault();let b;if(9===a.keyCode||16===a.keyCode)return b=a.target,void(b.focused=!0);if(32===a.keyCode&&(b=a.target),a.target.classList.contains("checkbox-group")){const c=a.target;b=c.querySelector("input[type=checkbox]")}b.checked=!b.checked}async function sha1(a){a=a.toLowerCase();const b=new TextEncoder("utf-8").encode(a);let c=/edge/i.test(navigator.userAgent)?libpolycrypt.sha1(b):await crypto.subtle.digest("SHA-1",b);const d=Array.from(new Uint8Array(c)),e=d.map(a=>("00"+a.toString(16)).slice(-2)).join("");return e.toUpperCase()}async function hashEmailAndSend(a){const b=a.target;ga_sendPing("Scan",!1),b.classList.add("loading-data");const c=document.getElementById("scan-email");b.querySelector("input[name=emailHash]").value=await sha1(c.value),c.value="",b.submit()}const resendSubscribeData=function(){ga_sendPing("Resend",!1),document.getElementById("confirm-your-account").classList.add("sending");const a={email:document.getElementById("submitted-email").textContent};postData("/user/add",a).then(()=>{document.getElementById("confirm-your-account").classList.add("sent"),document.getElementById("resend-data").removeEventListener("click",resendSubscribeData)}).catch(a=>console.error(a))},addUser=a=>{const b=a.target,c={};c.email=b.querySelector("#subscribe-email-input").value,b.querySelector("input[type=checkbox]").checked&&(c.additionalEmails="Opt user in to additional emails"),postData(b.action,c).then(()=>{document.getElementById("subscribe-to-ffxm").classList.remove("show"),document.getElementById("confirm-your-account").classList.add("show"),setModalTabbing(),document.getElementById("submitted-email").textContent=c.email,document.getElementById("resend-data").addEventListener("click",resendSubscribeData)}).catch(a=>console.error(a))},unsubscribeSurvey=a=>{const b=a.target;ga_sendPing("UnsubscribeSurvey",b.querySelector("input[type='radio']:checked").dataset.analyticsLabel);postData(b.action,{}).then(()=>{b.classList.add("show-thankyou")})},postData=(a,b={})=>fetch(a,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},referrer:"no-referrer",body:JSON.stringify(b)}).then(a=>a.json()).catch(a=>console.error(a));function showAdditionalBreaches(){document.getElementById("show-additional-breaches").classList.toggle("hide");const a=document.getElementById("additional-breaches");a.classList.toggle("show-breaches")}const handleRadioButtons=function(a){const b=Array.from(a.querySelectorAll(".radio-button-group, .button"));for(let c=0;c<b.length;c++){const d=b[c];d.addEventListener("focus",()=>{a.classList.contains("invalid")&&a.classList.remove("invalid"),d.addEventListener("keydown",a=>{38===a.keyCode&&b[c-1]&&b[c-1].focus(),40===a.keyCode&&b[c+1]&&b[c+1].focus(),32===a.keyCode&&d.classList.contains("radio-button-group")&&(b[c].querySelector("input").checked=!0)})})}};function addFormListeners(){Array.from(document.forms).forEach(a=>{if(a.querySelector("input[type=email]")){const b=a.querySelector("input[type=email]");b.addEventListener("keydown",a=>removeInvalidMessage(a))}if(a.querySelector("input[type=checkbox]")){const b=a.querySelector(".checkbox-group");b.addEventListener("click",a=>checkBoxStates(a)),b.addEventListener("keyup",a=>checkBoxStates(a))}a.querySelector("input[type=radio]")&&handleRadioButtons(a),a.addEventListener("submit",a=>handleFormSubmits(a))})}function handleFormSubmits(a){if("unsubscribe-form"===a.target.id)return void ga_sendPing("Unsubscribe",!1);if(a.preventDefault(),"unsubscribe-survey-form"===a.target.id)return a.target.querySelector("input[type='radio']:checked")?void unsubscribeSurvey(a):void a.target.classList.add("invalid");const b=a.target,c=b.email.value.trim();return(b.email.value=c,!c||!isValidEmail(c))?void b.classList.add("invalid"):b.classList.contains("email-scan")?void hashEmailAndSend(a):"subscribe-form"===a.target.id?(a.target.classList.add("loading-data"),addUser(a),setModalTabbing(),void ga_sendPing("SignUp_Complete",!1)):void a.submit()}function doButtonRouting(a){return"show-additional-breaches"===a.target.id?(ga_sendPing("ShowAdditional",!1),void showAdditionalBreaches()):"sign-up"===a.target.id?(ga_sendPing("SignUp",!1),void openModalWindow()):"subscribe-fxa-btn"===a.target.id?(doOauth(),void closeModalWindow()):a.target.classList.contains("close-modal")?(ga_sendPing("CloseModal",a.target.dataset.analyticsLabel),void closeModalWindow()):void 0}function restoreInputs(){Array.from(document.forms).forEach(a=>{a.classList.remove("loading-data"),a.classList.remove("invalid")}),document.querySelectorAll("input").forEach(a=>{a.disabled&&(a.disabled=!1)})}document.addEventListener("touchstart",function(){},!0),window.addEventListener("pageshow",function(){ga_sendPing("Pageview",!1),document.forms&&restoreInputs()}),document.forms&&addFormListeners(),document.getElementById("subpage")&&document.body.classList.add("sub"),document.getElementById("no-breaches")&&document.getElementById("scan-another-email").classList.add("banner"),document.querySelectorAll("[data-analytics-event]").forEach(a=>{a.addEventListener("click",a=>{ga_sendPing(a.target.dataset.analyticsEvent,a.target.dataset.analyticsLabel)})}),document.querySelectorAll(".breach-logo").forEach(a=>{a.addEventListener("error",a=>{a.target.src="/img/logos/missing-logo-icon.png"})}),document.querySelectorAll("button")&&document.querySelectorAll("button").forEach(a=>{a.addEventListener("click",a=>doButtonRouting(a))});